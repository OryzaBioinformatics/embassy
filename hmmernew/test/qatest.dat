####################################################
# HMMERNEW
# 1. Examples taken mostly from hmmer 2.3.2 tutorial
# 2. Data lives in: /emboss/emboss/test/data/hmmnew
# 3. Do not use FZ lines as hmmer tends to write 
#    date info. to output files. 
####################################################

ID ehmmbuild-keep
AB hmmernew
RQ hmmer
AA ehmmbuild
DL keep
CL ../../data/hmmnew/globins50.msf globin.hmm -nhmm globins50 -strategy D
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /^Build a profile HMM from an alignment\.\n/
FI stdout
FC = 37
FP /^\S+hmmbuild -n globins50  --pbswitch 1000  --archpri 0\.850000  --idlevel 0\.620000  --swentry 0\.500000  --swexit 0\.500000  --wgsc  -A -F  globin\.hmm \.\.\/\.\.\/data\/hmmnew\/globins50\.msf\n/
FP /^Average score:      189\.04 bits\n/
FP /^Constructed a profile HMM \(length 143\)\n/
FI globin.hmm
FC = 447
FP /^COM   \S+hmmbuild -n globins50 --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F globin\.hmm \.\.\/\.\.\/data\/hmmnew\/globins50\.msf\n/
FP /^CKSUM 9858\n/
//

ID ehmmbuild-keep2
AB hmmernew
RQ hmmer
AA ehmmbuild
DL keep
CL ../../data/hmmnew/rrm.sto myhmms -nhmm rrm -strategy D
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /^Build a profile HMM from an alignment\.\n/
FI stdout
FC = 37
FP /^\S+hmmbuild -n rrm  --pbswitch 1000  --archpri 0\.850000  --idlevel 0\.620000  --swentry 0\.500000  --swexit 0\.500000  --wgsc  -A -F  myhmms \.\.\/\.\.\/data\/hmmnew\/rrm\.sto\n/
FP /^Constructed a profile HMM \(length 77\)\n/
FI myhmms
FC = 249
FP /^COM   \S+hmmbuild -n rrm --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/rrm\.sto\n/
FP /^CKSUM 8325\n/
//

ID ehmmbuild-keep3
AB hmmernew
RQ hmmer
AA ehmmbuild
DL keep
## myhmms is overwritten, so copy file to ensure output of previous test is not overwritten.
PP cp ../ehmmbuild-keep2/myhmms ./
CL ../../data/hmmnew/fn3.sto myhmms -nhmm fn3 -strategy D
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /^Build a profile HMM from an alignment\.\n/
FI stdout
FC = 37
FP /^\S+hmmbuild -n fn3  --pbswitch 1000  --archpri 0\.850000  --idlevel 0\.620000  --swentry 0\.500000  --swexit 0\.500000  --wgsc  -A -F  myhmms \.\.\/\.\.\/data\/hmmnew\/fn3\.sto\n/
FP /^Constructed a profile HMM \(length 84\)\n/
FI myhmms
FC = 523
FP /^COM   \S+hmmbuild -n rrm --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/rrm\.sto\n/
FP /^COM   \S+hmmbuild -n fn3 --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/fn3\.sto\n/
FP /^CKSUM 8325\n/
FP /^CKSUM 6130\n/
//

ID ehmmbuild-keep4
AB hmmernew
RQ hmmer
AA ehmmbuild
DL keep
## myhmms is overwritten, so copy file to ensure output of previous test is not overwritten.
PP cp ../ehmmbuild-keep3/myhmms ./
CL ../../data/hmmnew/pkinase.sto myhmms -nhmm pkinase -strategy D
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /^Build a profile HMM from an alignment\.\n/
FI stdout
FC = 37
FP /^\S+hmmbuild -n pkinase  --pbswitch 1000  --archpri 0\.850000  --idlevel 0\.620000  --swentry 0\.500000  --swexit 0\.500000  --wgsc  -A -F  myhmms \.\.\/\.\.\/data\/hmmnew\/pkinase\.sto\n/
FP /^Constructed a profile HMM \(length 294\)\n/
FI myhmms
FC = 1427
FP /^COM   \S+hmmbuild -n rrm --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/rrm\.sto\n/
FP /^COM   \S+hmmbuild -n fn3 --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/fn3\.sto\n/
FP /^COM   \S+hmmbuild -n pkinase --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/pkinase\.sto\n/
FP /^CKSUM 8325\n/
FP /^CKSUM 6130\n/
FP /^CKSUM 4536\n/
//

ID ehmmcalibrate-keep
AB hmmernew
RQ hmmer
AA ehmmcalibrate
TI 120
DL keep
CL ../ehmmbuild-keep/globin.hmm globino.hmm -seed 1
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /Calibrate HMM search statistics\n/
FI stdout
FC = 21
FP /^\S+hmmcalibrate --mean 350\.000000  --num 5000  --sd 350\.000000  --seed 1 \.\.\/ehmmbuild-keep\/globin\.hmm\n/
FP /^HMM file:                 \.\.\/ehmmbuild-keep\/globin\.hmm\n/
FI globino.hmm
FC = 449
FP /^COM   \S+hmmbuild -n globins50 --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F globin\.hmm \.\.\/\.\.\/data\/hmmnew\/globins50\.msf\n/
FP /^COM   \S+hmmcalibrate --mean 350\.000000 --num 5000 --sd 350\.000000 --seed 1 \.\.\/ehmmbuild-keep\/globin\.hmm\n/
FP /^CKSUM 9858\n/
//

ID ehmmcalibrate-keep2
AB hmmernew
RQ hmmer
AA ehmmcalibrate
DL keep
TI 120
CL ../ehmmbuild-keep4/myhmms myhmmso -seed 1
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /Calibrate HMM search statistics\n/
FI stdout
FC = 31
FP /^\S+hmmcalibrate --mean 350\.000000  --num 5000  --sd 350\.000000  --seed 1 \.\.\/ehmmbuild-keep4\/myhmms\n/
FP /^HMM file:                 \.\.\/ehmmbuild-keep4\/myhmms\n/
FI myhmmso
FC = 1433
FP /^COM   \S+hmmbuild -n rrm --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/rrm\.sto\n/
FP /^COM   \S+hmmcalibrate --mean 350\.000000 --num 5000 --sd 350\.000000 --seed 1 \.\.\/ehmmbuild-keep4\/myhmms\n/
FP /^COM   \S+hmmbuild -n fn3 --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/fn3\.sto\n/
FP /^COM   \S+hmmcalibrate --mean 350\.000000 --num 5000 --sd 350\.000000 --seed 1 \.\.\/ehmmbuild-keep4\/myhmms\n/
FP /^COM   \S+hmmbuild -n pkinase --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/pkinase\.sto\n/
FP /^COM   \S+hmmcalibrate --mean 350\.000000 --num 5000 --sd 350\.000000 --seed 1 \.\.\/ehmmbuild-keep4\/myhmms\n/
FP /^CKSUM 8325\n/
FP /^CKSUM 6130\n/
FP /^CKSUM 4536\n/
//

ID ehmmsearch-keep
AB hmmernew
RQ hmmer
AA ehmmsearch
DL keep
CL ../ehmmcalibrate-keep/globino.hmm ../../data/hmmnew/Artemia.fa globino.ehmmsearch -a 100
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /^Search a sequence database with a profile HMM\n/
FI stdout
FC = 3
FP /^\S+hmmsearch -A 100 -E 10\.000000 -T -1000000\.000000 -Z 0 --domE 1000000\.000000 --domT -1000000\.000000  \.\.\/ehmmcalibrate-keep\/globino\.hmm \.\.\/\.\.\/data\/hmmnew\/Artemia\.fa > globino\.ehmmsearch\n/
FI globino.ehmmsearch
FC = 216
FP /^HMM file:                   \.\.\/ehmmcalibrate-keep\/globino\.hmm \[globins50\]\n/
FP /^     Total hits:           1\n/
FP /^     Total hits:           9\n/
//

ID ehmmpfam-keep
AB hmmernew
RQ hmmer
AA ehmmpfam
DL keep
CL ../ehmmcalibrate-keep2/myhmmso ../../data/hmmnew/7LES_DROME myhmmso.ehmmpfam -A 10 -E 10
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /^Search one or more sequences against an HMM database\.\n/
FI stdout
FC = 3
## This is not the full command-line so as to avoid checking against a (variable) temp. file name.
FP /^\S+hmmpfam -A 10 -E 10\.000000 -T -1000000\.000000 -Z 59021 --domE 1000000\.000000 --domT -1000000\.000000  --informat FASTA \.\.\/ehmmcalibrate-keep2\/myhmmso/
FI myhmmso.ehmmpfam
FC = 137
FP /^HMM file:                 \.\.\/ehmmcalibrate-keep2\/myhmmso\n/
FP /^fn3        6/6/
FP /^pkinase    1/1/
//

ID ehmmalign-keep
AB hmmernew
RQ hmmer
AA ehmmalign
DL keep
CL ../ehmmcalibrate-keep/globino.hmm ../../data/hmmnew/globins630.fa globins630.ali
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP /^Align sequences to an HMM profile\n/
FP 0 /Died: /
FI stdout
FC = 13
## This is not the full command-line so as to avoid checking against a (variable) temp. file name.
FP /^\S+hmmalign  --informat FASTA --outformat A2M  -o globins630\.ali \.\.\/ehmmcalibrate-keep\/globino\.hmm/
FP /^Alignment saved in file globins630\.ali\n/
FI globins630.ali
FC = 3150
FP /^>BAHG_VITSP \n/
FP /^>MYG_ZIPCA \n/
//

ID ehmmconvert-keep
AB hmmernew
RQ hmmer
AA ehmmconvert
DL keep
CL ../ehmmcalibrate-keep/globino.hmm globino.ehmmconvert -format G
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /^Convert between profile HMM file formats\n/
FI stdout
FC = 16
FP /^\S+hmmconvert -p  -F  \.\.\/ehmmcalibrate-keep\/globino\.hmm globino\.ehmmconvert\n/
FP /^1 HMM\(s\) converted and written to globino\.ehmmconvert\n/
FI globino.ehmmconvert
FC = 169
FP /^\(Peptide\) HMMCONVERT v2\.3\.2 Length: 143 globins50||\n/
FP /^ \*    621    74   359   488   301   325   254   392   570   697   178   318   209   339   312   490   400   555    65   192     0     0     0     0 \n/
//

ID ehmmemit-keep
AB hmmernew
RQ hmmer
AA ehmmemit
DL keep
CL ../ehmmcalibrate-keep/globino.hmm globino.ehmmemit -c N -n 10
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /^Generate sequences from a profile HMM\.\n/
FI stdout
FC = 14
FP /^\S+hmmemit --seed 0  -n 10  -o globino\.ehmmemit \.\.\/ehmmcalibrate-keep\/globino\.hmm\n/
FP /^Output saved in file globino\.ehmmemit\n/
FI globino.ehmmemit
FC = 40
FP /^>globins50-1 \n/
FP /^>globins50-10 \n/
FP /^AEQAIEMQLWHAVANAKKVEEEQVKRLYQDERGSTAHFMHYEKLRNNNDK\n/
//

ID ehmmindex-keep
AB hmmernew
RQ hmmer
AA ehmmindex
DL keep
## Outfile will be created in same directory as input file, therefore copy input file first. 
PP cp ../ehmmcalibrate-keep2/myhmmso ./
CL myhmmso
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /^Create a binary SSI index for an HMM database\.\n/
FI stdout
FC = 18
FP /^\S+hmmindex \.\/myhmmso\n/
FP /^SSI index:      \.\/myhmmso\.ssi\n/
FP /^# of HMMS:      3\n/
FI myhmmso.ssi
FP /pkinase/
FP /fn3/
FZ = 178
## Each file, including those copied in, needs a test.
## Use the test for myhmmso from ehmmcalibrate-keep2
## Can't use 'QQ rm myhmmso' as both myhmmso & myhmmso.ssi are needed by the next test.
FI myhmmso
FC = 1433
FP /^COM   \S+hmmbuild -n rrm --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/rrm\.sto\n/
FP /^COM   \S+hmmcalibrate --mean 350\.000000 --num 5000 --sd 350\.000000 --seed 1 \.\.\/ehmmbuild-keep4\/myhmms\n/
FP /^COM   \S+hmmbuild -n fn3 --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/fn3\.sto\n/
FP /^COM   \S+hmmcalibrate --mean 350\.000000 --num 5000 --sd 350\.000000 --seed 1 \.\.\/ehmmbuild-keep4\/myhmms\n/
FP /^COM   \S+hmmbuild -n pkinase --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/pkinase\.sto\n/
FP /^COM   \S+hmmcalibrate --mean 350\.000000 --num 5000 --sd 350\.000000 --seed 1 \.\.\/ehmmbuild-keep4\/myhmms\n/
FP /^CKSUM 8325\n/
FP /^CKSUM 6130\n/
FP /^CKSUM 4536\n/
//

ID ehmmfetch-keep
AB hmmernew
RQ hmmer
AA ehmmfetch
DL keep
CL ../ehmmindex-keep/myhmmso pkinase pkinase.ehmmfetch
FI stderr
FC = 1
FP 0 /Warning: /
FP 0 /Error: /
FP 0 /Died: /
FP /^Retrieve an HMM from an HMM database\.\n/
FI stdout
FC = 3
FP /^\S+hmmfetch \.\.\/ehmmindex-keep\/myhmmso pkinase > pkinase\.ehmmfetch\n/
FI pkinase.ehmmfetch
FC = 906
FP /^COM   \S+hmmbuild -n pkinase --pbswitch 1000 --archpri 0\.850000 --idlevel 0\.620000 --swentry 0\.500000 --swexit 0\.500000 --wgsc -A -F myhmms \.\.\/\.\.\/data\/hmmnew\/pkinase\.sto\n/
FP /^COM   \S+hmmcalibrate --mean 350\.000000 --num 5000 --sd 350\.000000 --seed 1 \.\.\/ehmmbuild-keep4\/myhmms\n/
FP /^CKSUM 4536\n/
//




